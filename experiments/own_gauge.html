<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html {
            height: 100%;
        }
        body {
            height: 100%;
            margin: 0px;
            padding: 0px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
        }
        #myCanvas {
            grid-area: 1/ 1;
            width: 100%;
            height: 100%;
            border: solid 1px blue;
        }
    </style>
</head>
<body>
<div id="grid">
    <canvas id="myCanvas"></canvas>
</div>
<script>
    (function() {
        var throttle = function(type, name, obj) {
            obj = obj || window;
            var running = false;
            var func = function() {
                if (running) { return; }
                running = true;
                requestAnimationFrame(function() {
                    obj.dispatchEvent(new CustomEvent(name));
                    running = false;
                });
            };
            obj.addEventListener(type, func);
        };

        /* init - you can init any event */
        throttle("resize", "optimizedResize");
    })();

    const canvas = document.getElementById('myCanvas');
    const context = canvas.getContext('2d');

    let percent = 0.5;
    let reverse = false;
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.clientHeight;
    console.log(canvas.width);
    console.log(canvas.height);

    window.addEventListener('optimizedResize', function(){
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.clientHeight;
        console.log(canvas.width);
        console.log(canvas.height);
    });
    function animate() {
        let centerX = canvas.width / 2;
        let centerY = 4* canvas.height / 5;
        let factor = Math.min(canvas.offsetHeight, canvas.offsetWidth);
        let radius = factor * 0.6;
        let thickness = 0.4;

        context.beginPath();
        context.lineCap = "round";
        context.arc(centerX, centerY, radius, -Math.PI+0.2, 0-0.2, false);
        context.arc(centerX, centerY, radius * (1 - thickness), 0-0.2,-Math.PI+0.2, true);
        context.closePath();
        context.fillStyle = '#484f57';
        context.fill();

        context.beginPath();
        context.lineCap = "round";

        let endAngle = (Math.PI-0.4)*percent-(Math.PI-0.2);

        context.arc(centerX, centerY, radius, -Math.PI+0.2, endAngle, false);
        context.arc(centerX, centerY, (radius) * (1 - thickness), endAngle,-Math.PI+0.2, true);
        context.closePath();
        context.fillStyle = '#2594eb';
        context.fill();

        if(reverse) {
            percent -= 0.01;
        } else {
            percent += 0.01;
        }
        if(percent >= 1 || percent <= 0) reverse = !reverse;
        requestAnimationFrame(animate);
    }

    requestAnimationFrame(animate);
</script>
</body>
</html>